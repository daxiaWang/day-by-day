{"version":3,"sources":["webpack:///./src/views/list/demo2.vue?7475","webpack:///./node_modules/core-js/modules/es.array.find-index.js","webpack:///./src/views/list/index.vue?d7ce","webpack:///./src/views/list/demo1.vue?3bca","webpack:///src/views/list/demo1.vue","webpack:///./src/views/list/demo1.vue?db1a","webpack:///./src/views/list/demo1.vue","webpack:///./src/views/list/demo2.vue?9019","webpack:///src/views/list/demo2.vue","webpack:///./src/views/list/demo2.vue?f9b8","webpack:///./src/views/list/demo2.vue","webpack:///src/views/list/index.vue","webpack:///./src/views/list/index.vue?3d14","webpack:///./src/views/list/index.vue"],"names":["$","$findIndex","findIndex","addToUnscopables","arrayMethodUsesToLength","FIND_INDEX","SKIPS_HOLES","USES_TO_LENGTH","Array","target","proto","forced","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","staticRenderFns","attrs","finished","on","onLoad","model","value","callback","$$v","loading","expression","_l","item","key","data","list","methods","setTimeout","temArr","push","i","component","_v","_s","treeList","created","from","console","log","mounted","window","addEventListener","that","lazyload","treeTranslate","newList","toTree","JSON","parse","stringify","scrollHeight","offsetHeight","viewHeight","imgs","src","tree","map","e","children","pid","e2","id","index","components","demo1","demo2"],"mappings":"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","file":"js/chunk-6e493fa1.ea38961d.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./demo2.vue?vue&type=style&index=0&id=4af18cfe&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./demo2.vue?vue&type=style&index=0&id=4af18cfe&lang=scss&scoped=true&\"","'use strict';\nvar $ = require('../internals/export');\nvar $findIndex = require('../internals/array-iteration').findIndex;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND_INDEX = 'findIndex';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND_INDEX);\n\n// Shouldn't skip holes\nif (FIND_INDEX in []) Array(1)[FIND_INDEX](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.findIndex` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.findindex\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND_INDEX);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('demo2')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\"},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.list),function(item){return _c('van-cell',{key:item,attrs:{\"title\":item}})}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <van-list\r\n      v-model=\"loading\"\r\n      :finished=\"finished\"\r\n      finished-text=\"没有更多了\"\r\n      @load=\"onLoad\"\r\n    >\r\n      <van-cell v-for=\"item in list\" :key=\"item\" :title=\"item\" />\r\n    </van-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      list: [],\r\n      loading: false,\r\n      finished: false\r\n    }\r\n  },\r\n  methods: {\r\n    onLoad() {\r\n      // 异步更新数据\r\n      // setTimeout 仅做示例，真实场景中一般为 ajax 请求\r\n      setTimeout(() => {\r\n        const temArr = []\r\n        for (let i = 0; i < 20; i++) {\r\n          // this.list.push(this.list.length + 1)\r\n          temArr.push(i)\r\n        }\r\n        this.list = this.list.concat(temArr)\r\n\r\n        // 加载状态结束\r\n        this.loading = false\r\n\r\n        // 数据全部加载完成\r\n        if (this.list.length >= 100) {\r\n          this.finished = true\r\n        }\r\n      }, 1000)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./demo1.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./demo1.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./demo1.vue?vue&type=template&id=07625f9b&scoped=true&\"\nimport script from \"./demo1.vue?vue&type=script&lang=js&\"\nexport * from \"./demo1.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"07625f9b\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('ul',_vm._l((_vm.list),function(item){return _c('li',{key:item,attrs:{\"data-src\":item}},[_vm._v(_vm._s(item))])}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <ul>\r\n      <li\r\n        v-for=\"item in list\"\r\n        :key=\"item\"\r\n        :data-src=\"item\"\r\n      >{{ item }}</li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      list: [],\r\n      treeList: [\r\n        {\r\n          id: 1,\r\n          pid: null,\r\n          label: '一级',\r\n          value: '1',\r\n          flag: true,\r\n          children: [\r\n            {\r\n              id: 2,\r\n              pid: 1,\r\n              label: '二级1',\r\n              value: '2.1',\r\n              flag: false,\r\n              children: []\r\n            },\r\n            {\r\n              id: 3,\r\n              pid: 1,\r\n              label: '二级2',\r\n              value: '2.2',\r\n              flag: true,\r\n              children: []\r\n            },\r\n            {\r\n              id: 4,\r\n              pid: 1,\r\n              label: '二级3',\r\n              value: '2.3',\r\n              flag: true,\r\n              children: [\r\n                {\r\n                  id: 5,\r\n                  pid: 4,\r\n                  label: '三级1',\r\n                  value: '3.1',\r\n                  flag: true,\r\n                  children: []\r\n                },\r\n                {\r\n                  id: 6,\r\n                  pid: 4,\r\n                  label: '三级2',\r\n                  value: '3.2',\r\n                  flag: true,\r\n                  children: []\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n\r\n    }\r\n  },\r\n  created() {\r\n    this.list = Array.from({ length: 600 }, (v, i) => i)\r\n    console.log('this.list', this.list)\r\n  },\r\n  mounted() {\r\n    const that = this\r\n    window.addEventListener('scroll', function() {\r\n      console.log('1')\r\n      that.lazyload()\r\n    })\r\n    const newList = []\r\n    console.log('扁平化前：', this.treeList)\r\n    this.treeTranslate(this.treeList, newList)\r\n    console.log('扁平化后：', newList)\r\n\r\n    // 反扁平化\r\n    this.toTree(JSON.parse(JSON.stringify(newList)))\r\n  },\r\n  methods: {\r\n    lazyload() {\r\n      const imgs = document.getElementsByTagName('li')\r\n      const len = imgs.length\r\n      // 视口的高度\r\n      const viewHeight = document.documentElement.clientHeight\r\n      // 滚动条高度\r\n      const scrollHeight =\r\n        document.documentElement.scrollTop || document.body.scrollTop\r\n      console.log('scrollHeight', scrollHeight)\r\n      for (let i = 0; i < len; i++) {\r\n        const offsetHeight = imgs[i].offsetTop\r\n        if (offsetHeight < viewHeight + scrollHeight) {\r\n          const src = imgs[i].dataset.src\r\n          imgs[i].src = src\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n   *将 tree 数据扁平化\r\n   * @param tree 需要被扁平化的具有层级结构的 tree 数据\r\n   * @param newList 接收扁平数据的数组\r\n   */\r\n    treeTranslate(tree, newList) {\r\n    // （tips：Mozilla上关于递归的这个术语，解释说一个递归函数可以接受两个输入参数：一个最终状态（终止递归）或一个递归状态（继续递归）。）\r\n    // 从两个入参的角度看，newList.length>10000 为真可以理解为“最终状态”。\r\n    // 这个条件设置无关业务，是出于极限保护设置的，可不设。因为假设这个 tree 数据扁平化后不可能超过 100000，\r\n    // 一旦超过说明出错了，所以做出了这个极限保护条件。\r\n      if (newList.length > 100000) {\r\n        return\r\n      }\r\n\r\n      tree.map(e => {\r\n        newList.push(e)\r\n\r\n        // 自己调用自己，条件是 e.children.length 为真\r\n        // 从两个入参的角度看，e.children.length 为真可以理解为“递归状态”。\r\n        if (e.children && e.children.length) {\r\n          this.treeTranslate(e.children, newList)\r\n        }\r\n      })\r\n    },\r\n\r\n    /**\r\n   * 反扁平化：将扁平数据转换为 tree 数据\r\n   * @param list 扁平数据\r\n   */\r\n    toTree(list) {\r\n      const tree = []\r\n      list.map(e => {\r\n      // 以 e.pid===null,作为判断是否根节点的依据，或者直接写死根节点（如果确定的话），\r\n      // 具体以什么为根节点的依据得看数据的设计规则，通常是判断层级或是否根节点的标记\r\n        if (e.pid === null) {\r\n          tree.push(e)\r\n        }\r\n\r\n        list.map(e2 => {\r\n          if (e2.pid === e.id) {\r\n          // 避免出现重复数据\r\n            const index = e.children.findIndex(sub => sub.id === e2.id)\r\n            if (index === -1) {\r\n              e.children.push(e2)\r\n            }\r\n          }\r\n        })\r\n      })\r\n\r\n      console.log('反扁平化后：', tree)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\nli{\r\n  padding: 20px;\r\n  font-size: 30px;\r\n  border-bottom: 1px solid #ddd;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./demo2.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./demo2.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./demo2.vue?vue&type=template&id=4af18cfe&scoped=true&\"\nimport script from \"./demo2.vue?vue&type=script&lang=js&\"\nexport * from \"./demo2.vue?vue&type=script&lang=js&\"\nimport style0 from \"./demo2.vue?vue&type=style&index=0&id=4af18cfe&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4af18cfe\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n    <!-- <demo1></demo1> -->\r\n    <demo2 />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport demo1 from './demo1.vue'\r\nimport demo2 from './demo2.vue'\r\nexport default {\r\n  components: {\r\n    demo1,\r\n    demo2\r\n  },\r\n  data() {\r\n    return {\r\n      list: []\r\n    }\r\n  },\r\n  methods: {\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1ac1e658&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1ac1e658\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}